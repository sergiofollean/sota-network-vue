(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20f951"],{b3f0:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("base-tf-selector",{attrs:{charts:e.tfs,width:e.width,height:e.height,period:e.period},on:{selected:e.on_selected}}),a("trading-vue",{ref:"tradingVue",attrs:{data:e.chart,overlays:e.overlays,width:e.width,height:e.height,"title-txt":e.symbol,toolbar:!0,tf:e.period}})],1)},n=[],c=a("5530"),i=a("b85c"),s=a("1da1"),h=(a("96cf"),a("a9e3"),a("07ac"),a("0d03"),a("a434"),a("d81d"),a("4160"),a("159b"),a("b0c0"),a("a15b"),a("b64b"),a("99af"),a("0042")),d=a.n(h),o=a("5cd2"),u=a.n(o),l=a("b704"),m=a.n(l),p=a("bc3a"),b=a.n(p),f=a("1c46"),g={name:"graph",components:{TradingVue:d.a},props:{symbolName:{type:String,default:"BTCUSDT"},symbolPeriod:{type:String,default:"1m"},width:{type:Number,default:500},height:{type:Number,default:600},apiKey:{type:String},apiSecret:{type:String}},created:function(){return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},data:function(){return{overlays:Object.values(m.a),timer:"",symbol:this.symbolName,period:this.symbolPeriod,tfs:{"1m":{},"3m":{},"5m":{},"15m":{},"1h":{},"4h":{}},chart:new h["DataCube"]({chart:{tf:"1m",data:[]}}),wk:1,wss:[],token:this.apiKey,secret:this.apiSecret,binance:new u.a({apiKey:this.token,apiSecret:this.secret})}},methods:{rerender:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n,s,h,d,o,l,m,p,g,w,N,v,j;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=(new Date).getTime(),e.binance=new u.a({apiKey:e.apiKey,apiSecret:e.apiSecret}),e.wss.length>0){r=Object(i["a"])(e.wss);try{for(r.s();!(n=r.n()).done;)s=n.value,s(),e.wss.splice(0,1)}catch(O){r.e(O)}finally{r.f()}}return e.chart.set("chart.data",[]),t.next=6,e.binance.candles({symbol:e.symbol,interval:e.period});case 6:return h=t.sent,e.chart.set("chart.data",h.map((function(e){return[e.openTime,Number(e.open),Number(e.high),Number(e.low),Number(e.close),Number(e.volume)]}))),t.next=10,e.binance.ws.candles(e.symbol,e.period,(function(t){e.chart.data.chart.data[e.chart.data.chart.data.length-1].length&&e.chart.data.chart.data[e.chart.data.chart.data.length-1][0]===t.startTime?e.chart.data.chart.data.splice(e.chart.data.chart.data.length-1,1,[t.startTime,Number(t.open),Number(t.high),Number(t.low),Number(t.close),Number(t.volume)]):e.chart.data.chart.data.push([t.startTime,Number(t.open),Number(t.high),Number(t.low),Number(t.close),Number(t.volume)])}));case 10:if(d=t.sent,e.wss.length>0){o=Object(i["a"])(e.wss);try{for(o.s();!(l=o.n()).done;)m=l.value,m(),e.wss.splice(0,1)}catch(O){o.e(O)}finally{o.f()}}if(e.wss.push(d),e.chart.del("Trades"),e.chart.del("EMA"),e.chart.del("Ichi"),e.chart.add("onchart",{name:"Ichi",type:"Ichi",data:[]}),e.chart.add("onchart",{name:"EMA 33",type:"EMA",data:[],settings:{length:33,lineWidth:1}}),e.chart.add("onchart",{name:"EMA 55",type:"EMA",data:[],settings:{length:55,lineWidth:2}}),e.chart.add("onchart",{name:"EMA 120",type:"EMA",data:[],settings:{length:120,lineWidth:3}}),e.$refs.tradingVue.resetChart(),!(e.apiKey&&e.apiKey.length>0&&e.apiSecret&&e.apiSecret.length>0)){t.next=34;break}return p=[],p["symbol"]=e.symbol,p["timestamp"]=a,g=Object(f["createHmac"])("sha256",e.secret).update(y(Object(c["a"])({},p)).substr(1)).digest("hex"),w=Object(c["a"])(Object(c["a"])({},p),{},{signature:g}),t.next=29,b.a.get("http://localhost:8080/api/v3/allOrders"+y(Object(c["a"])({},w)),{headers:{"X-MBX-APIKEY":e.apiKey}});case 29:N=t.sent,v=N.data,j=[],v.forEach((function(e){if("FILLED"===e.status){var t="BUY"===e.side?1:0;j.push([Number(e.updateTime),Number(t),Number(e.price),e.side])}})),e.chart.add("onchart",{name:"Trades",type:"TradesPlus",data:j,settings:{"z-index":10}});case 34:case"end":return t.stop()}}),t)})))()},on_selected:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.period=e.name,t.chart.set("chart.tf",e.name),a.next=4,t.rerender();case 4:case"end":return a.stop()}}),a)})))()},findNearestCandle:function(e){var t=0,a=this.chart.data.chart.data[1][0]-this.chart.data.chart.data[0][0],r=this.chart.data.chart.data[t];while(e-r[0]>0)r=this.chart.data.chart.data[t++];return r[0]-e<a?this.chart.data.chart.data[t++]:null}},watch:{symbolName:function(e,t){this.symbol=e,this.on_selected({i:0,name:"1m"}),this.rerender()},apiSecret:function(e,t){this.secret=e,this.on_selected({i:0,name:"1m"})},apiKey:function(e,t){this.token=e,this.on_selected({i:0,name:"1m"})}}},y=function(e){return e?"?".concat(Object.keys(e).map((function(t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t]))})).join("&")):""},w=g,N=a("2877"),v=Object(N["a"])(w,r,n,!1,null,null,null);t["default"]=v.exports}}]);
//# sourceMappingURL=chunk-2d20f951.382b808c.js.map