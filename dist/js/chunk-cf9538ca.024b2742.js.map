{"version":3,"sources":["webpack:///./src/views/app/dashboard/FutureGraph.vue?064f","webpack:///src/views/app/dashboard/FutureGraph.vue","webpack:///./src/views/app/dashboard/FutureGraph.vue?c32a","webpack:///./src/views/app/dashboard/FutureGraph.vue","webpack:///./src/views/app/dashboard/Test.vue?abf3","webpack:///src/views/app/dashboard/Test.vue","webpack:///./src/views/app/dashboard/Test.vue?bf1a","webpack:///./src/views/app/dashboard/Test.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","tfs","width","height","period","on","on_selected","ref","chart","overlays","symbol","staticRenderFns","name","components","props","symbolName","type","String","default","symbolPeriod","Number","apiKey","apiSecret","data","Object","values","timer","tf","wk","wss","token","secret","binance","methods","findNearestCandle","time","candle","counter","step","watch","newVal","rerender","component","_v","_s","setNewValue","futureGraph"],"mappings":"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","file":"js/chunk-cf9538ca.024b2742.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('base-tf-selector',{attrs:{\"charts\":_vm.tfs,\"width\":_vm.width,\"height\":_vm.height,\"period\":_vm.period},on:{\"selected\":_vm.on_selected}}),_c('trading-vue',{ref:\"tradingVue\",attrs:{\"data\":_vm.chart,\"overlays\":_vm.overlays,\"width\":_vm.width,\"height\":_vm.height,\"title-txt\":_vm.symbol,\"toolbar\":true,\"tf\":_vm.period}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <base-tf-selector :charts=\"tfs\" :width=\"width\" :height=\"height\" v-on:selected=\"on_selected\" :period=\"period\">\n    </base-tf-selector>\n    <trading-vue :data=\"chart\" :overlays=\"overlays\" :width=\"width\" :height=\"height\" :title-txt=\"symbol\" :toolbar=\"true\" :tf=\"period\" ref=\"tradingVue\"></trading-vue>\n  </div>\n</template>\n<script>\nimport TradingVue from \"trading-vue-js\";\nimport Binance from 'binance-api-node'\nimport { DataCube } from \"trading-vue-js\";\nimport Overlays from 'tvjs-overlays'\n\nexport default {\n  name: 'futureGraph',\n  components: { TradingVue },\n  props: {\n    symbolName: {\n      type: String,\n      default: 'BTCUSDT'\n    },\n    symbolPeriod: {\n      type: String,\n      default: '1m'\n    },\n    width: {\n      type: Number,\n      default: 500\n    },\n    height: {\n      type: Number,\n      default: 600\n    },\n    apiKey: {\n      type: String\n    },\n    apiSecret: {\n      type: String\n    }\n  },\n  async created() {\n\n  },\n  data() {\n    return {\n      overlays: Object.values(Overlays),\n      timer: '',\n      symbol: this.symbolName,\n      period: this.symbolPeriod,\n      tfs: {'1m': {}, '3m': {}, '5m': {}, '15m': {}, '1h': {}, '4h': {}},\n      chart: new DataCube({\n        chart: {\n          tf: '1m',\n          data: []\n        }\n      }),\n      wk: 1,\n      wss: [],\n      token: this.apiKey,\n      secret: this.apiSecret,\n      binance: new Binance({\n        apiKey: this.token,\n        apiSecret: this.secret\n      })\n    }\n  },\n  methods: {\n    async on_selected(tf) {\n      this.period = tf.name;\n      this.chart.set('chart.tf', tf.name);\n      await this.rerender();\n    },\n    async rerender() {\n      console.log('rerender');\n      this.binance = new Binance({\n        apiKey: this.apiKey,\n        apiSecret: this.apiSecret\n      })\n      if (this.wss.length > 0) {\n        for(const ws of this.wss) {\n          ws();\n          this.wss.splice(0, 1);\n        }\n      }\n      this.chart.set('chart.data', []);\n      let candleChartResults = await this.binance.futuresCandles({ symbol: this.symbol, interval: this.period });\n      this.chart.set('chart.data', candleChartResults.map((candle) => {\n        return [candle.openTime, Number(candle.open), Number(candle.high), Number(candle.low), Number(candle.close) , Number(candle.volume)];\n      }));\n\n      const ws = await this.binance.ws.futuresCandles(this.symbol, this.period, candle => {\n        if (this.chart.data.chart.data[this.chart.data.chart.data.length - 1].length && this.chart.data.chart.data[this.chart.data.chart.data.length - 1][0] === candle.startTime) {\n          this.chart.data.chart.data.splice(this.chart.data.chart.data.length - 1, 1,\n              [candle.startTime, Number(candle.open), Number(candle.high), Number(candle.low), Number(candle.close), Number(candle.volume)]);\n        } else {\n          this.chart.data.chart.data.push([candle.startTime, Number(candle.open), Number(candle.high), Number(candle.low), Number(candle.close), Number(candle.volume)]);\n        }\n      })\n      if (this.wss.length > 0) {\n        for(const ws of this.wss) {\n          ws();\n          this.wss.splice(0, 1);\n        }\n      }\n      this.wss.push(ws);\n      this.chart.del('Trades')\n      this.chart.del('EMA')\n      this.chart.del('Ichi')\n      this.chart.add('onchart', { name: 'Ichi', type: 'Ichi', data: [] });\n\n      this.chart.add('onchart', { name: 'EMA 33', type: 'EMA', data: [], settings: {\n          length: 33,\n          lineWidth: 1\n        }})\n      this.chart.add('onchart', { name: 'EMA 55', type: 'EMA', data: [], settings: {\n          length: 55,\n          lineWidth: 2\n        }})\n      this.chart.add('onchart', { name: 'EMA 120', type: 'EMA', data: [], settings: {\n          length: 120,\n          lineWidth: 3\n        }})\n      this.$refs.tradingVue.resetChart();\n      if (this.apiKey && this.apiKey.length > 0 && this.apiSecret && this.apiSecret.length > 0) {\n        const orders = await this.binance.futuresAllOrders({\n          symbol: this.symbol,\n        });\n        const ordersData = [];\n        const orderIds = []\n        orders.forEach((order) => {\n          if (order.status === 'FILLED') {\n            const orderType = order.side === 'BUY' ? 1 : 0;\n            const orderPos = order.side === 'BUY' ? order.positionSide.substr(0, 1) : 'Sell'\n            if (orderIds[order.orderId]) {\n              orderIds[order.orderId].push(order);\n            } else {\n              orderIds[order.orderId] = [order];\n            }\n            let data = this.findNearestCandle(order.time);\n            if (data) {\n              ordersData.push([\n                Number(data[0]), Number(orderType), Number(order.avgPrice), orderPos\n              ]);\n            }\n          }\n        });\n        this.chart.add('onchart', { name: 'Trades', type: 'TradesPlus', data: ordersData, settings: {\n            'z-index': 10\n          }})\n        }\n    },\n    findNearestCandle(time) {\n      let counter = 0;\n      const step = this.chart.data.chart.data[1][0] - this.chart.data.chart.data[0][0];\n      let candle = this.chart.data.chart.data[counter];\n      while (time - candle[0] > 0) {\n        candle = this.chart.data.chart.data[counter++];\n      }\n      return candle[0] - time < step ? this.chart.data.chart.data[counter++] : null;\n    }\n  },\n  watch: {\n    symbolName: function(newVal, oldVal) {\n      this.symbol = newVal;\n      this.on_selected({i: 0, name: '1m'})\n      this.rerender();\n    },\n    apiSecret: function(newVal, oldVal) {\n      this.secret = newVal;\n      this.on_selected({i: 0, name: '1m'})\n    },\n    apiKey: function(newVal, oldVal) {\n      this.token = newVal;\n      this.on_selected({i: 0, name: '1m'})\n    }\n  }\n}\n\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FutureGraph.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FutureGraph.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FutureGraph.vue?vue&type=template&id=e5e0d332&\"\nimport script from \"./FutureGraph.vue?vue&type=script&lang=js&\"\nexport * from \"./FutureGraph.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('future-graph',{attrs:{\"width\":1200,\"height\":800,\"symbol-name\":_vm.symbolName,\"symbol-period\":'1m',\"api-key\":_vm.apiKey,\"api-secret\":'rJZ80K7NEyGRrhZHgqR5IwNZBBFd54ihQZKdmX4gYDy14lIB2NgTI03iMMXCtxTa'}}),_c('p',[_vm._v(_vm._s(_vm.apiKey))]),_c('button',{on:{\"click\":_vm.setNewValue}},[_vm._v(\"Set new value\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <future-graph :width=\"1200\" :height=\"800\" :symbol-name=\"symbolName\" :symbol-period=\"'1m'\"\n           :api-key=\"apiKey\"\n           :api-secret=\"'rJZ80K7NEyGRrhZHgqR5IwNZBBFd54ihQZKdmX4gYDy14lIB2NgTI03iMMXCtxTa'\">\n    </future-graph>\n    <p>{{ apiKey }}</p>\n  <button v-on:click=\"setNewValue\">Set new value</button>\n  </div>\n</template>\n<script>\nimport futureGraph from './FutureGraph'\nexport default {\n  components: {\n    futureGraph\n  },\n  data() {\n    return {\n      apiKey: 'cIOx48OYVU8ixZ6C7ZmXhxMDOdAcTOnO49Qk9drn3QfppGttCf00VR3Z2Mj4kNGR',\n      symbolName: 'BTCUSDT'\n    }\n  },\n  methods: {\n    setNewValue: function () {\n      this.apiKey = 'cIOx48OYVU8ixZ6C7ZmXhxMDOdAcTOnO49Qk9drn3QfppGttCf00VR3Z2Mj4kNGR';\n      this.symbolName = 'XRPUSDT';\n    }\n  }\n\n}\n</script>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Test.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Test.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Test.vue?vue&type=template&id=4217580e&\"\nimport script from \"./Test.vue?vue&type=script&lang=js&\"\nexport * from \"./Test.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}